(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsPublicGatewayChecker = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsPublicGatewayChecker=(()=>{var mt=Object.create;var Z=Object.defineProperty;var yt=Object.getOwnPropertyDescriptor;var gt=Object.getOwnPropertyNames;var wt=Object.getPrototypeOf,_t=Object.prototype.hasOwnProperty;var bt=f=>Z(f,"__esModule",{value:!0});var vt=(f,e)=>()=>(e||f((e={exports:{}}).exports,e),e.exports);var kt=(f,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of gt(e))!_t.call(f,a)&&a!=="default"&&Z(f,a,{get:()=>e[a],enumerable:!(r=yt(e,a))||r.enumerable});return f},xt=f=>kt(bt(Z(f!=null?mt(wt(f)):{},"default",f&&f.__esModule&&"default"in f?{get:()=>f.default,enumerable:!0}:{value:f,enumerable:!0})),f);var L=(f,e,r)=>new Promise((a,n)=>{var y=w=>{try{l(r.next(w))}catch(N){n(N)}},c=w=>{try{l(r.throw(w))}catch(N){n(N)}},l=w=>w.done?a(w.value):Promise.resolve(w.value).then(y,c);l((r=r.apply(f,e)).next())});var ht=vt(($,Q)=>{(function(f){"use strict";function e(r){var a=r&&r.Promise||f.Promise,n=r&&r.XMLHttpRequest||f.XMLHttpRequest;return function(){var y=Object.create(f,{fetch:{value:void 0,writable:!0}});return function(c,l){typeof $=="object"&&typeof Q!="undefined"?l($):typeof define=="function"&&define.amd?define(["exports"],l):l(c.WHATWGFetch={})}(this,function(c){"use strict";var l=typeof y!="undefined"&&y||typeof self!="undefined"&&self||typeof l!="undefined"&&l,w={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function N(t){return t&&DataView.prototype.isPrototypeOf(t)}if(w.arrayBuffer)var C=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],j=ArrayBuffer.isView||function(t){return t&&C.indexOf(Object.prototype.toString.call(t))>-1};function T(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function H(t){return typeof t!="string"&&(t=String(t)),t}function o(t){var i={next:function(){var u=t.shift();return{done:u===void 0,value:u}}};return w.iterable&&(i[Symbol.iterator]=function(){return i}),i}function h(t){this.map={},t instanceof h?t.forEach(function(i,u){this.append(u,i)},this):Array.isArray(t)?t.forEach(function(i){this.append(i[0],i[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(i){this.append(i,t[i])},this)}h.prototype.append=function(t,i){t=T(t),i=H(i);var u=this.map[t];this.map[t]=u?u+", "+i:i},h.prototype.delete=function(t){delete this.map[T(t)]},h.prototype.get=function(t){return t=T(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(T(t))},h.prototype.set=function(t,i){this.map[T(t)]=H(i)},h.prototype.forEach=function(t,i){for(var u in this.map)this.map.hasOwnProperty(u)&&t.call(i,this.map[u],u,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(i,u){t.push(u)}),o(t)},h.prototype.values=function(){var t=[];return this.forEach(function(i){t.push(i)}),o(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(i,u){t.push([u,i])}),o(t)},w.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function d(t){if(t.bodyUsed)return a.reject(new TypeError("Already read"));t.bodyUsed=!0}function k(t){return new a(function(i,u){t.onload=function(){i(t.result)},t.onerror=function(){u(t.error)}})}function m(t){var i=new FileReader,u=k(i);return i.readAsArrayBuffer(t),u}function A(t){var i=new FileReader,u=k(i);return i.readAsText(t),u}function p(t){for(var i=new Uint8Array(t),u=new Array(i.length),_=0;_<i.length;_++)u[_]=String.fromCharCode(i[_]);return u.join("")}function G(t){if(t.slice)return t.slice(0);var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t)),i.buffer}function q(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:w.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:w.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:w.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():w.arrayBuffer&&w.blob&&N(t)?(this._bodyArrayBuffer=G(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):w.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||j(t))?this._bodyArrayBuffer=G(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):w.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},w.blob&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return a.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return a.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return a.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=d(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?a.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):a.resolve(this._bodyArrayBuffer))}else return this.blob().then(m)}),this.text=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return a.resolve(p(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return a.resolve(this._bodyText)},w.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}var W=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function s(t){var i=t.toUpperCase();return W.indexOf(i)>-1?i:t}function U(t,i){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');i=i||{};var u=i.body;if(t instanceof U){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,i.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!u&&t._bodyInit!=null&&(u=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=i.credentials||this.credentials||"same-origin",(i.headers||!this.headers)&&(this.headers=new h(i.headers)),this.method=s(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.signal=i.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&u)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(u),(this.method==="GET"||this.method==="HEAD")&&(i.cache==="no-store"||i.cache==="no-cache")){var _=/([?&])_=[^&]*/;if(_.test(this.url))this.url=this.url.replace(_,"$1_="+new Date().getTime());else{var v=/\?/;this.url+=(v.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function B(t){var i=new FormData;return t.trim().split("&").forEach(function(u){if(u){var _=u.split("="),v=_.shift().replace(/\+/g," "),g=_.join("=").replace(/\+/g," ");i.append(decodeURIComponent(v),decodeURIComponent(g))}}),i}function M(t){var i=new h,u=t.replace(/\r?\n[\t ]+/g," ");return u.split("\r").map(function(_){return _.indexOf(`
`)===0?_.substr(1,_.length):_}).forEach(function(_){var v=_.split(":"),g=v.shift().trim();if(g){var V=v.join(":").trim();i.append(g,V)}}),i}q.call(U.prototype);function x(t,i){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');i||(i={}),this.type="default",this.status=i.status===void 0?200:i.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in i?i.statusText:"",this.headers=new h(i.headers),this.url=i.url||"",this._initBody(t)}q.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},x.error=function(){var t=new x(null,{status:0,statusText:""});return t.type="error",t};var z=[301,302,303,307,308];x.redirect=function(t,i){if(z.indexOf(i)===-1)throw new RangeError("Invalid status code");return new x(null,{status:i,headers:{location:t}})},c.DOMException=l.DOMException;try{new c.DOMException}catch(t){c.DOMException=function(i,u){this.message=i,this.name=u;var _=Error(i);this.stack=_.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function P(t,i){return new a(function(u,_){var v=new U(t,i);if(v.signal&&v.signal.aborted)return _(new c.DOMException("Aborted","AbortError"));var g=new n;function V(){g.abort()}g.onload=function(){var E={status:g.status,statusText:g.statusText,headers:M(g.getAllResponseHeaders()||"")};E.url="responseURL"in g?g.responseURL:E.headers.get("X-Request-URL");var X="response"in g?g.response:g.responseText;setTimeout(function(){u(new x(X,E))},0)},g.onerror=function(){setTimeout(function(){_(new TypeError("Network request failed"))},0)},g.ontimeout=function(){setTimeout(function(){_(new TypeError("Network request failed"))},0)},g.onabort=function(){setTimeout(function(){_(new c.DOMException("Aborted","AbortError"))},0)};function dt(E){try{return E===""&&l.location.href?l.location.href:E}catch(X){return E}}g.open(v.method,dt(v.url),!0),v.credentials==="include"?g.withCredentials=!0:v.credentials==="omit"&&(g.withCredentials=!1),"responseType"in g&&(w.blob?g.responseType="blob":w.arrayBuffer&&v.headers.get("Content-Type")&&v.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(g.responseType="arraybuffer")),i&&typeof i.headers=="object"&&!(i.headers instanceof h)?Object.getOwnPropertyNames(i.headers).forEach(function(E){g.setRequestHeader(E,H(i.headers[E]))}):v.headers.forEach(function(E,X){g.setRequestHeader(X,E)}),v.signal&&(v.signal.addEventListener("abort",V),g.onreadystatechange=function(){g.readyState===4&&v.signal.removeEventListener("abort",V)}),g.send(typeof v._bodyInit=="undefined"?null:v._bodyInit)})}P.polyfill=!0,l.fetch||(l.fetch=P,l.Headers=h,l.Request=U,l.Response=x),c.Headers=h,c.Request=U,c.Response=x,c.fetch=P,Object.defineProperty(c,"__esModule",{value:!0})}),{fetch:y.fetch,Headers:y.Headers,Request:y.Request,Response:y.Response,DOMException:y.DOMException}}()}typeof define=="function"&&define.amd?define(function(){return e}):typeof $=="object"?Q.exports=e:f.fetchPonyfill=e})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof globalThis!="undefined"?globalThis:$)});function Tt(){var f=Object.create(null);f.ftp=21,f.file=0,f.gopher=70,f.http=80,f.https=443,f.ws=80,f.wss=443;var e=Object.create(null);e["%2e"]=".",e[".%2e"]="..",e["%2e."]="..",e["%2e%2e"]="..";function r(o){return f[o]!==void 0}function a(){j.call(this),this._isInvalid=!0}function n(o){return o==""&&a.call(this),o.toLowerCase()}function y(o){var h=o.charCodeAt(0);return h>32&&h<127&&[34,35,60,62,63,96].indexOf(h)==-1?o:encodeURIComponent(o)}function c(o){var h=o.charCodeAt(0);return h>32&&h<127&&[34,35,60,62,96].indexOf(h)==-1?o:encodeURIComponent(o)}var l=void 0,w=/[a-zA-Z]/,N=/[a-zA-Z0-9\+\-\.]/;function C(o,h,d){function k(i){W.push(i)}var m=h||"scheme start",A=0,p="",G=!1,q=!1,W=[];t:for(;(o[A-1]!=l||A==0)&&!this._isInvalid;){var s=o[A];switch(m){case"scheme start":if(s&&w.test(s))p+=s.toLowerCase(),m="scheme";else if(h){k("Invalid scheme.");break t}else{p="",m="no scheme";continue}break;case"scheme":if(s&&N.test(s))p+=s.toLowerCase();else if(s==":"){if(this._scheme=p,p="",h)break t;r(this._scheme)&&(this._isRelative=!0),this._scheme=="file"?m="relative":this._isRelative&&d&&d._scheme==this._scheme?m="relative or authority":this._isRelative?m="authority first slash":m="scheme data"}else if(h){if(l==s)break t;k("Code point not allowed in scheme: "+s);break t}else{p="",A=0,m="no scheme";continue}break;case"scheme data":s=="?"?(this._query="?",m="query"):s=="#"?(this._fragment="#",m="fragment"):l!=s&&s!="	"&&s!=`
`&&s!="\r"&&(this._schemeData+=y(s));break;case"no scheme":if(!d||!r(d._scheme))k("Missing scheme."),a.call(this);else{m="relative";continue}break;case"relative or authority":if(s=="/"&&o[A+1]=="/")m="authority ignore slashes";else{k("Expected /, got: "+s),m="relative";continue}break;case"relative":if(this._isRelative=!0,this._scheme!="file"&&(this._scheme=d._scheme),l==s){this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query=d._query,this._username=d._username,this._password=d._password;break t}else if(s=="/"||s=="\\")s=="\\"&&k("\\ is an invalid code point."),m="relative slash";else if(s=="?")this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query="?",this._username=d._username,this._password=d._password,m="query";else if(s=="#")this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query=d._query,this._fragment="#",this._username=d._username,this._password=d._password,m="fragment";else{var U=o[A+1],B=o[A+2];(this._scheme!="file"||!w.test(s)||U!=":"&&U!="|"||l!=B&&B!="/"&&B!="\\"&&B!="?"&&B!="#")&&(this._host=d._host,this._port=d._port,this._username=d._username,this._password=d._password,this._path=d._path.slice(),this._path.pop()),m="relative path";continue}break;case"relative slash":if(s=="/"||s=="\\")s=="\\"&&k("\\ is an invalid code point."),this._scheme=="file"?m="file host":m="authority ignore slashes";else{this._scheme!="file"&&(this._host=d._host,this._port=d._port,this._username=d._username,this._password=d._password),m="relative path";continue}break;case"authority first slash":if(s=="/")m="authority second slash";else{k("Expected '/', got: "+s),m="authority ignore slashes";continue}break;case"authority second slash":if(m="authority ignore slashes",s!="/"){k("Expected '/', got: "+s);continue}break;case"authority ignore slashes":if(s!="/"&&s!="\\"){m="authority";continue}else k("Expected authority, got: "+s);break;case"authority":if(s=="@"){G&&(k("@ already seen."),p+="%40"),G=!0;for(var M=0;M<p.length;M++){var x=p[M];if(x=="	"||x==`
`||x=="\r"){k("Invalid whitespace in authority.");continue}if(x==":"&&this._password===null){this._password="";continue}var z=y(x);this._password!==null?this._password+=z:this._username+=z}p=""}else if(l==s||s=="/"||s=="\\"||s=="?"||s=="#"){A-=p.length,p="",m="host";continue}else p+=s;break;case"file host":if(l==s||s=="/"||s=="\\"||s=="?"||s=="#"){p.length==2&&w.test(p[0])&&(p[1]==":"||p[1]=="|")?m="relative path":(p.length==0||(this._host=n.call(this,p),p=""),m="relative path start");continue}else s=="	"||s==`
`||s=="\r"?k("Invalid whitespace in file host."):p+=s;break;case"host":case"hostname":if(s==":"&&!q){if(this._host=n.call(this,p),p="",m="port",h=="hostname")break t}else if(l==s||s=="/"||s=="\\"||s=="?"||s=="#"){if(this._host=n.call(this,p),p="",m="relative path start",h)break t;continue}else s!="	"&&s!=`
`&&s!="\r"?(s=="["?q=!0:s=="]"&&(q=!1),p+=s):k("Invalid code point in host/hostname: "+s);break;case"port":if(/[0-9]/.test(s))p+=s;else if(l==s||s=="/"||s=="\\"||s=="?"||s=="#"||h){if(p!=""){var P=parseInt(p,10);P!=f[this._scheme]&&(this._port=P+""),p=""}if(h)break t;m="relative path start";continue}else s=="	"||s==`
`||s=="\r"?k("Invalid code point in port: "+s):a.call(this);break;case"relative path start":if(s=="\\"&&k("'\\' not allowed in path."),m="relative path",s!="/"&&s!="\\")continue;break;case"relative path":if(l==s||s=="/"||s=="\\"||!h&&(s=="?"||s=="#")){s=="\\"&&k("\\ not allowed in relative path.");var t;(t=e[p.toLowerCase()])&&(p=t),p==".."?(this._path.pop(),s!="/"&&s!="\\"&&this._path.push("")):p=="."&&s!="/"&&s!="\\"?this._path.push(""):p!="."&&(this._scheme=="file"&&this._path.length==0&&p.length==2&&w.test(p[0])&&p[1]=="|"&&(p=p[0]+":"),this._path.push(p)),p="",s=="?"?(this._query="?",m="query"):s=="#"&&(this._fragment="#",m="fragment")}else s!="	"&&s!=`
`&&s!="\r"&&(p+=y(s));break;case"query":!h&&s=="#"?(this._fragment="#",m="fragment"):l!=s&&s!="	"&&s!=`
`&&s!="\r"&&(this._query+=c(s));break;case"fragment":l!=s&&s!="	"&&s!=`
`&&s!="\r"&&(this._fragment+=s);break}A++}}function j(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function T(o,h){h!==void 0&&!(h instanceof T)&&(h=new T(String(h))),o=String(o),this._url=o,j.call(this);var d=o.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");C.call(this,d,null,h)}T.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var o="";return(this._username!=""||this._password!=null)&&(o=this._username+(this._password!=null?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+o+this.host:"")+this.pathname+this._query+this._fragment},set href(o){j.call(this),C.call(this,o)},get protocol(){return this._scheme+":"},set protocol(o){this._isInvalid||C.call(this,o+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(o){this._isInvalid||!this._isRelative||C.call(this,o,"host")},get hostname(){return this._host},set hostname(o){this._isInvalid||!this._isRelative||C.call(this,o,"hostname")},get port(){return this._port},set port(o){this._isInvalid||!this._isRelative||C.call(this,o,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(o){this._isInvalid||!this._isRelative||(this._path=[],C.call(this,o,"relative path start"))},get search(){return this._isInvalid||!this._query||this._query=="?"?"":this._query},set search(o){this._isInvalid||!this._isRelative||(this._query="?",o[0]=="?"&&(o=o.slice(1)),C.call(this,o,"query"))},get hash(){return this._isInvalid||!this._fragment||this._fragment=="#"?"":this._fragment},set hash(o){this._isInvalid||(this._fragment="#",o[0]=="#"&&(o=o.slice(1)),C.call(this,o,"fragment"))},get origin(){var o;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return o=this.host,o?this._scheme+"://"+o:""}};var H=self.URL;return H&&(T.createObjectURL=function(o){return H.createObjectURL.apply(H,arguments)},T.revokeObjectURL=function(o){H.revokeObjectURL(o)}),T}var R=Tt();var ft=xt(ht());var O;(function(c){c.pending="\u{1F551}",c.successful="\u2705",c.caution="\u26A0\uFE0F",c.failed="\u274C",c.global="\u{1F30D}",c.asterisk="*"})(O||(O={}));var I=class{constructor(e="div",r=void 0,a=O.pending){let n=document.createElement(e);this.element=n,r!=null&&(this.className=r),this.textContent=a}static fromElement(e){let r=new I("div");return r.element=e,r}asterisk(){}lose(){this.textContent=O.failed}win(){this.textContent=O.successful}global(){this.textContent=O.global}err(){this.textContent=O.caution}get style(){return this.element.style}append(e){return e instanceof I&&(e=e.element),this.element.append(e)}get classList(){return this.element.classList}set title(e){this.element.title=e}set className(e){this.element.className=e}set textContent(e){this.element.textContent=e}};var S=class{constructor(e,...r){this.parent=e;this.tag=new I(...r)}};var Y=class extends S{constructor(e,...r){super(e,...r);this.parent=e;this._className="Not-set";this._tagName="Not-set"}get className(){return this._className}get tagName(){return this._tagName}check(){}checked(){}onerror(){this.tag.err()}};var D=class{constructor(e){this.namespace=e}log(e,...r){let[a,n]=r,y=this.namespace!=null?`${this.namespace}: `:"";console[e](`${y}${a}`,n)}debug(...e){this.log("debug",...e)}info(...e){this.log("info",...e)}warn(...e){this.log("warn",...e)}error(...e){this.log("error",...e)}};var pt=new D("Util"),F=class{static checkViaImgSrc(e){return L(this,null,function*(){let r=15e3;return yield new Promise((a,n)=>{let y=setTimeout(()=>{c()&&n(new Error("Timer was already cancelled"))},r),c=()=>y==null?!1:(clearTimeout(y),y=null,!0),l=new Image;l.onerror=()=>{c(),n(new Error("image error"))},l.onload=()=>{c(),a()},l.src=e.toString()})})}static gatewayHostname(e){let r=e.toString();return(e==null?void 0:e.hostname)!=null&&(r=e.hostname.toString()),r.replace(`${F.HASH_TO_TEST}.ipfs.`,"").replace(`${F.HASH_TO_TEST}.`,"")}static OnScriptloaded(e){try{let a=new R(e).searchParams.get("i");if(a!=null){let n=window.checker.nodes[Number(a)];n!=null&&n.checked()}}catch(r){pt.error(r)}}static expectSubdomainRedirect(e){return L(this,null,function*(){return yield new Promise((r,a)=>{let n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){let{hostname:y}=new R(n.responseURL);y.startsWith(F.IMG_HASH)?r():a(new Error("Expected to be redirected to subdomain where first DNS label is CID"))},n.onerror=function(y){pt.error(e,y),a(y)},n.send(null)})})}},b=F;b.HASH_TO_TEST="bafybeifx7yeb55armcsxwwitkymga5xf53dxiarykms3ygqic223w5sk3m",b.IMG_HASH="bafybeibwzifw52ttrkqlikfzext5akxu7lz4xiwjgwzmqcpdzmp3n5vnbe",b.HASH_STRING="Hello from IPFS Gateway Checker",b.ipfs_http_client=window.IpfsHttpClient({host:"ipfs.io",port:443,protocol:"https"});var{fetch:Et}=(0,ft.default)(),lt=new D("Cors"),K=class extends Y{constructor(e){super(e,"div","Cors");this.parent=e;this._className="Cors";this._tagName="div"}check(){let e=Date.now(),a=`${this.parent.gateway.replace(":hash",b.HASH_TO_TEST)}?now=${e}#x-ipfs-companion-no-redirect`;Et(a).then(n=>L(this,null,function*(){return yield n.text()})).then(n=>{b.HASH_STRING===n.trim()?(this.parent.checked(),this.tag.asterisk(),this.parent.tag.classList.add("cors")):this.onerror()}).catch(n=>{lt.error(n),this.onerror()})}checked(){lt.warn("Not implemented yet")}onerror(){this.tag.err()}};var tt=new D("Flag"),et=class extends S{constructor(e,r){super(e,"div","Flag");this.parent=e;this.hostname=r;this.setup()}setup(){let e=!0;try{let r=localStorage.getItem(this.hostname);if(r!=null){let a=JSON.parse(r),n=Date.now(),y=a.time,c=n-y,l=7*24*60*60*1e3;c<l&&(e=!1,this.onResponse(a))}}catch(r){tt.error(`error while getting savedSTR for ${this.hostname}`,r)}e&&setTimeout(this.dnsRequest.bind(this),500*et.requests++)}dnsRequest(){let e=new XMLHttpRequest;e.open("GET",`https://cloudflare-dns.com/dns-query?name=${this.hostname}&type=A`),e.setRequestHeader("accept","application/dns-json"),e.onreadystatechange=()=>L(this,null,function*(){e.readyState===4&&e.status===200&&(yield this.handleSuccessfulRequest(e))}),e.onerror=r=>{tt.error(r)},e.send()}handleSuccessfulRequest(e){return L(this,null,function*(){try{let r=JSON.parse(e.responseText),a=null;for(let n=0;n<r.Answer.length&&a==null;n++){let y=r.Answer[n];y.type===1&&(a=y.data)}if(a!=null){let n=yield window.IpfsGeoip.lookup(b.ipfs_http_client,a);if((n==null?void 0:n.country_code)!=null){this.onResponse(n),n.time=Date.now();let y=JSON.stringify(n);localStorage.setItem(this.hostname,y)}}}catch(r){tt.error(`error while getting DNS A record for ${this.hostname}`,r)}})}onResponse(e){this.tag.style["background-image"]=`url('https://ipfs.io/ipfs/QmaYjj5BHGAWfopTdE8ESzypbuthsZqTeqz9rEuh3EJZi6/${e.country_code.toLowerCase()}.svg')`,this.tag.title=e.country_name}},J=et;J.requests=0;var st=class{constructor(e){this.parent=e;this.tag=new I("div","Origin")}check(){let e=new R(this.parent.gateway),r=new R(`${e.protocol}//${b.IMG_HASH}.ipfs.${e.hostname}/?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`),a=new R(`${e.protocol}//${e.hostname}/ipfs/${b.IMG_HASH}?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`);b.checkViaImgSrc(r).then(()=>L(this,null,function*(){return yield b.expectSubdomainRedirect(a).then(()=>{this.tag.win(),this.parent.tag.classList.add("origin"),this.parent.checked()})})).catch(()=>this.onerror())}onerror(){this.tag.err()}};var it=class extends S{constructor(e){super(e,"div","Status");this.parent=e;this.up=!1}check(){let e=new R(this.parent.gateway),r=new R(`${e.protocol}//${e.hostname}/ipfs/${b.IMG_HASH}?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`);b.checkViaImgSrc(r).then(()=>{this.tag.lose(),this.parent.checked()}).catch(()=>{this.up||(this.up=!1,this.tag.lose(),this.parent.failed())})}checked(){this.up=!0,this.tag.global(),this.parent.tag.classList.add("online")}onerror(){throw new Error("Not implemented")}};var rt=class extends S{constructor(e,r,a){super(e,"div","Node");this.parent=e;this.tag.style.order=Date.now().toString(),this.status=new it(this),this.tag.append(this.status.tag),this.cors=new K(this),this.tag.append(this.cors.tag),this.origin=new st(this),this.tag.append(this.origin.tag),this.link=document.createElement("div");let n=r.replace(":hash",b.HASH_TO_TEST);this.link.url=new R(n),this.link.textContent=b.gatewayHostname(this.link.url),this.link.className="Link",this.flag=new J(this,this.link.textContent),this.tag.append(this.flag.tag),this.tag.append(this.link),this.took=document.createElement("div"),this.took.className="Took",this.tag.append(this.took),this.gateway=r,this.index=a,this.checkingTime=0}check(){this.checkingTime=Date.now(),this.status.check(),this.cors.check(),this.origin.check()}checked(){if(!this.status.up){this.status.checked(),this.parent.checked();let e=this.link.url;if(e!=null){let n=b.gatewayHostname(e);this.link.innerHTML=`<a title="${n}" href="${e.toString()}#x-ipfs-companion-no-redirect" target="_blank">${n}</a>`}let r=Date.now()-this.checkingTime;this.tag.style.order=r.toString();let a=(r/1e3).toFixed(2);this.took.textContent=`${a}s`}}failed(){this.parent.failed()}onerror(){this.tag.err()}};var ot=class{constructor(e){this.parent=e;let r=document.getElementById("checker.results");if(r==null)throw new Error('Element with Id "checker.results" not found.');this.element=r}append(e){this.element.append(e.element)}checked(){this.parent.updateStats()}failed(){this.parent.updateStats()}};var at=class extends S{constructor(e){super(e);this.parent=e;let r=document.getElementById("checker.stats");if(r==null)throw new Error('Could not find element with Id "checker.stats"');this.tag=I.fromElement(r),this.gateways=document.createElement("div"),this.gateways.textContent="0/0 tested",this.gateways.className="Gateways",this.tag.append(this.gateways),this.totals=document.createElement("div"),this.totals.textContent="0 online",this.totals.className="Totals",this.tag.append(this.totals)}update(){let e=0,r=0;for(let a of this.parent.nodes)"up"in a.status&&(a.status.up?++e:++r);this.gateways.textContent=`${e+r}/${this.parent.nodes.length} tested`,this.totals.textContent=`${e} online`}};var nt=class{constructor(){this.nodes=[];let e=document.getElementById("checker");if(e==null)throw new Error('Element with Id "checker" not found.');this.element=e,this.stats=new at(this),this.results=new ot(this)}updateStats(){this.stats.update()}checkGateways(e){for(let r of e){let a=new rt(this.results,r,this.nodes.length);this.nodes.push(a),this.results.append(a.tag),setTimeout(()=>a.check(),100*this.nodes.length)}}};var ct=["https://ipfs.io/ipfs/:hash","https://dweb.link/ipfs/:hash","https://gateway.ipfs.io/ipfs/:hash","https://ipfs.infura.io/ipfs/:hash","https://infura-ipfs.io/ipfs/:hash","https://ninetailed.ninja/ipfs/:hash","https://10.via0.com/ipfs/:hash","https://ipfs.eternum.io/ipfs/:hash","https://hardbin.com/ipfs/:hash","https://gateway.blocksec.com/ipfs/:hash","https://cloudflare-ipfs.com/ipfs/:hash","https://astyanax.io/ipfs/:hash","https://cf-ipfs.com/ipfs/:hash","https://ipns.co/ipfs/:hash","https://ipfs.mrh.io/ipfs/:hash","https://gateway.originprotocol.com/ipfs/:hash","https://gateway.pinata.cloud/ipfs/:hash","https://ipfs.doolta.com/ipfs/:hash","https://ipfs.sloppyta.co/ipfs/:hash","https://ipfs.busy.org/ipfs/:hash","https://ipfs.greyh.at/ipfs/:hash","https://gateway.serph.network/ipfs/:hash","https://jorropo.net/ipfs/:hash","https://gateway.temporal.cloud/ipfs/:hash","https://ipfs.fooock.com/ipfs/:hash","https://cdn.cwinfo.net/ipfs/:hash","https://aragon.ventures/ipfs/:hash","https://ipfs-cdn.aragon.ventures/ipfs/:hash","https://permaweb.io/ipfs/:hash","https://ipfs.stibarc.com/ipfs/:hash","https://ipfs.best-practice.se/ipfs/:hash","https://2read.net/ipfs/:hash","https://ipfs.2read.net/ipfs/:hash","https://storjipfs-gateway.com/ipfs/:hash","https://ipfs.runfission.com/ipfs/:hash","https://ipfs.trusti.id/ipfs/:hash","https://ipfs.overpi.com/ipfs/:hash","https://gateway.ipfs.lc/ipfs/:hash","https://ipfs.leiyun.org/ipfs/:hash","https://ipfs.ink/ipfs/:hash","https://ipfs.oceanprotocol.com/ipfs/:hash","https://d26g9c7mfuzstv.cloudfront.net/ipfs/:hash","https://ipfsgateway.makersplace.com/ipfs/:hash","https://gateway.ravenland.org/ipfs/:hash","https://ipfs.funnychain.co/ipfs/:hash","https://ipfs.telos.miami/ipfs/:hash","https://robotizing.net/ipfs/:hash","https://ipfs.mttk.net/ipfs/:hash","https://ipfs.fleek.co/ipfs/:hash","https://ipfs.jbb.one/ipfs/:hash","https://ipfs.yt/ipfs/:hash","https://jacl.tech/ipfs/:hash","https://hashnews.k1ic.com/ipfs/:hash","https://ipfs.vip/ipfs/:hash","https://ipfs.k1ic.com/ipfs/:hash","https://ipfs.drink.cafe/ipfs/:hash","https://ipfs.azurewebsites.net/ipfs/:hash","https://gw.ipfspin.com/ipfs/:hash","https://ipfs.kavin.rocks/ipfs/:hash","https://ipfs.denarius.io/ipfs/:hash","https://ipfs.mihir.ch/ipfs/:hash","https://bluelight.link/ipfs/:hash","https://crustwebsites.net/ipfs/:hash","http://3.211.196.68:8080/ipfs/:hash","https://ipfs0.sjc.cloudsigma.com/ipfs/:hash","https://ipfs-tezos.giganode.io/ipfs/:hash","http://183.252.17.149:82/ipfs/:hash","http://ipfs.genenetwork.org/ipfs/:hash","https://ipfs.eth.aragon.network/ipfs/:hash","https://ipfs.smartholdem.io/ipfs/:hash","https://bin.d0x.to/ipfs/:hash","https://ipfs.xoqq.ch/ipfs/:hash","http://natoboram.mynetgear.com:8080/ipfs/:hash","https://video.oneloveipfs.com/ipfs/:hash","http://ipfs.anonymize.com/ipfs/:hash","https://ipfs.noormohammed.tech/ipfs/:hash","https://ipfs.taxi/ipfs/:hash","https://ipfs.scalaproject.io/ipfs/:hash","https://search.ipfsgate.com/ipfs/:hash","https://ipfs.itargo.io/ipfs/:hash","https://ipfs.decoo.io/ipfs/:hash","https://ivoputzer.xyz/ipfs/:hash","https://alexdav.id/ipfs/:hash","https://ipfs.uploads.nu/ipfs/:hash","https://hub.textile.io/ipfs/:hash","https://ipfs1.pixura.io/ipfs/:hash","https://ravencoinipfs-gateway.com/ipfs/:hash","https://konubinix.eu/ipfs/:hash","https://ipfs.clansty.com/ipfs/:hash","https://3cloud.ee/ipfs/:hash","https://ipfs.tubby.cloud/ipfs/:hash","https://ipfs.lain.la/ipfs/:hash","https://ipfs.adatools.io/ipfs/:hash","https://ipfs.kaleido.art/ipfs/:hash","https://ipfs.slang.cx/ipfs/:hash","https://ipfs.arching-kaos.com/ipfs/:hash","https://storry.tv/ipfs/:hash","https://ipfs.kxv.io/ipfs/:hash","https://ipfs-nosub.stibarc.com/ipfs/:hash","https://ipfs.1-2.dev/ipfs/:hash","https://dweb.eu.org/ipfs/:hash","https://permaweb.eu.org/ipfs/:hash","https://ipfs.namebase.io/ipfs/:hash","https://ipfs.tribecap.co/ipfs/:hash","https://ipfs.kinematiks.com/ipfs/:hash"];window.OnScriptloaded=b.OnScriptloaded;var ut=new nt;window.checker=ut;ut.checkGateways(ct);})();
return IpfsPublicGatewayChecker}));
